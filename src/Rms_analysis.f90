!! Rms_analysis.f90 is a part of the PACIAE event generator.
!! Copyright (C) 2024 PACIAE Group.
!! PACIAE is licensed under the GNU GPL v2 or later, see LICENSE for details.
!! Open source: https://github.com/ArcsaberHep/PACIAE4
!! Author: An-Ke Lei, August 2023 - November 2024.

!> This is a standalone averaging program to do average over "rms.out" files
!!  generated by PACIAE simulations.

!!                                              By An-Ke at CCNU on 19/08/2023
!!                                 Last updated by An-Ke at UiO  on 17/01/2025


    program rms_analysis
!#TODO(Lei20240220): not good for lepton-induced collisions from PACIAE.
!       implicit none
        implicit real(kind=8) (a-h, o-z)
        implicit integer (i-n)
        integer :: n_file, n_event_per_file, n_event_total
        integer :: n_parton_specie, n_particle_specie, n_distribution, n_kine_cut, n_bin_hist
        character(len=50) :: name_file, prefix, infix, suffix
        integer :: i_sim_mode, n_current_date_and_time(8)
        real(kind=8) :: Ncoll_in_coll_list, Npart_in_coll_list, Ncoll_max_in_coll_list,         &
                        Ncoll_call_PYTHIA, Ncoll_not_call_PYTHIA, Npart_real,                   &
                        Ncoll_over_Npart_Optical_Glauber_multi_string, Ncoll_Optical_Glauber,   &
                        Npart_call_PYTHIA, Ncoll_nn_call_PYTHIA, Ncoll_pp_call_PYTHIA,          &
                        Ncoll_np_call_PYTHIA, Ncoll_call_PYTHIA_2, Ncoll_lp_call_PYTHIA,        &
                        Npart_Optical_Glauber_proj, Npart_Optical_Glauber_targ,                 &
                        Overlap_function_Optical_Glauber, Ncoll_Optical_Glauber_2,              &
                        n_coll_parton_rescattering_success, n_coll_parton_rescattering_block,   &
                        n_coll_parton_rescattering_total, n_coll_parton_rescattering,           &
                        n_coll_hadron_rescattering_elastic, n_coll_hadron_rescattering_inelastic,   &
                        n_coll_hadron_rescattering_total, n_gluon_in_a_string_single_multi_string,  &
                        n_string_single_string, n_q_thrown, n_qbar_thrown,                      &
                        multiplicity_minus_partial, multiplicity_plus_partial, multiplicity_total_partial,  &
                        multiplicity_minus_full, multiplicity_plus_full, multiplicity_total_full,   &
                        multiplicity_quark_partial, multiplicity_qbar_partial,                  &
                        multiplicity_q_qbar_total_partial, multiplicity_gluon_partial,          &
                        multiplicity_quark_full, multiplicity_qbar_full,                        &
                        multiplicity_q_qbar_total_full, multiplicity_gluon_full,                &
                        kapa_effective
        real(kind=8) :: n_process_parton_rescattering(20),  sum_n_process_parton_rescattering(20),    &
                        n_process_hadron_rescattering(10,60), sum_n_process_hadron_rescattering(10,60)
        character(len=3000) :: comment_line(3000)
        character(len=4) :: c_date_and_time(8)
        character(len=4) :: id_abscissa(10)
        data id_abscissa / "y", "pT", "eta", "mT", "mult", "pT", "mult", "", "", "" /
        real(kind=8),allocatable :: multiplicity_specie_partial(:), sum_multiplicity_specie_partial(:), &
                                    multiplicity_specie_full(:),    sum_multiplicity_specie_full(:),    &
                                    multiplicity_parton_partial(:), sum_multiplicity_parton_partial(:), &
                                    multiplicity_parton_full(:), sum_multiplicity_parton_full(:),       &
                                    mean_pT_specie_partial(:),      sum_mean_pT_specie_partial(:),      &
                                    mean_pT_specie_full(:),         sum_mean_pT_specie_full(:),         &
                                    mean_pT_parton_partial(:),      sum_mean_pT_parton_partial(:),      &
                                    mean_pT_parton_full(:),         sum_mean_pT_parton_full(:)
        real(kind=8),allocatable :: x_coor(:,:)
        real(kind=8),allocatable :: distr_hadron_partial(:,:,:), sum_distr_hadron_partial(:,:,:),    &
                                    distr_hadron_full(:,:,:),    sum_distr_hadron_full(:,:,:),       &
                                    distr_parton_partial(:,:,:), sum_distr_parton_partial(:,:,:),    &
                                    distr_parton_full(:,:,:),    sum_distr_parton_full(:,:,:)
        character(len=26),allocatable :: name_specie(:), name_parton(:)
        real(kind=8) :: sum_bParam_ANG(3), sum_sigma_ANG(8,2), sum_Ncoll_ANG(8), sum_Npart_ANG(4,2)
        real(kind=8) :: nCollND, nCollSDP, nCollSDT, nCollDD, nCollCD, nCollEl, nCollTot
        real(kind=8) :: nPartProj, nAbsProj, nDiffProj, nElProj, nPartTarg, nAbsTarg, nDiffTarg, nElTarg
        real(kind=8) :: sum_sigma_NN_tot_parini, sum_sigma_NN_tot_hadcas
        real(kind=8) :: max_lost_4mom(4), max_lost_4mom0(4)
        ! For mean pT <pT>.
        real(kind=8),allocatable :: sum_num_h_mean_pT(:,:), num_h_mean_pT(:,:), &
                                    sum_num_p_mean_pT(:,:), num_p_mean_pT(:,:)
        ! For flows.
        real(kind=8),allocatable :: num_h_integral_v(:,:),    &
                                    flow_h_integral_v(:,:,:), &
                                    dN_h_flow_f(:,:,:),   dN_h_flow(:,:,:),     &
                                    dv_h_flow_f(:,:,:,:), dv_h_flow(:,:,:,:),   &
                                    sum_num_h_integral_v(:,:),     &
                                    sum_flow_h_integral_v(:,:,:),  &
                                    sum_dN_h_flow_f(:,:,:),   sum_dN_h_flow(:,:,:), &
                                    sum_dv_h_flow_f(:,:,:,:), sum_dv_h_flow(:,:,:,:)
        real(kind=8),allocatable :: num_p_integral_v(:,:),    &
                                    flow_p_integral_v(:,:,:), &
                                    dN_p_flow_f(:,:,:),   dN_p_flow(:,:,:),   &
                                    dv_p_flow_f(:,:,:,:), dv_p_flow(:,:,:,:), &
                                    sum_num_p_integral_v(:,:),    &
                                    sum_flow_p_integral_v(:,:,:), &
                                    sum_dN_p_flow_f(:,:,:),   sum_dN_p_flow(:,:,:),   &
                                    sum_dv_p_flow_f(:,:,:,:), sum_dv_p_flow(:,:,:,:)


! Reads out input parameters from the "input_rms_analysis.dat".
        open( unit=98, file="input_rms_analysis.dat", status="unknown" )
        read(98,*) n_file, n_event_per_file
        read(98,*) i_sim_mode, i_b_sampling_method
        read(98,*) n_particle_specie, n_distribution, n_kine_cut, n_bin_hist
        close(98)
! For mean pT <pT>.
        n_distribution = n_distribution + 1
! "15" means g, u+d+s & anti-, u, ubar ..., t, tbar, diquarks.
! "+ 3" means "total", "charged" and "pi+K+p"
        n_parton_specie = 15
        n_particle_specie = n_particle_specie + 3
        n_event_total = 0
        ! n_event_total = n_file * n_event_per_file
        n_partial_and_full = 2

! Allocates memory.
        allocate(     multiplicity_specie_partial( n_particle_specie ), &
                  sum_multiplicity_specie_partial( n_particle_specie ), &
                      multiplicity_specie_full( n_particle_specie ),    &
                  sum_multiplicity_specie_full( n_particle_specie ),    &
                      multiplicity_parton_partial( n_parton_specie ),   &
                  sum_multiplicity_parton_partial( n_parton_specie ),   &
                      multiplicity_parton_full( n_parton_specie ),      &
                  sum_multiplicity_parton_full( n_parton_specie ),      &
                      mean_pT_specie_partial( n_particle_specie ),      &
                  sum_mean_pT_specie_partial( n_particle_specie ),      &
                      mean_pT_specie_full( n_particle_specie ),         &
                  sum_mean_pT_specie_full( n_particle_specie ),         &
                      mean_pT_parton_partial( n_parton_specie ),        &
                  sum_mean_pT_parton_partial( n_parton_specie ),        &
                      mean_pT_parton_full( n_parton_specie ),           &
                  sum_mean_pT_parton_full( n_parton_specie ),           &
                  x_coor( n_bin_hist, n_distribution ),                 &
                      distr_hadron_partial( n_particle_specie, n_bin_hist, n_distribution ), &
                  sum_distr_hadron_partial( n_particle_specie, n_bin_hist, n_distribution ), &
                      distr_hadron_full( n_particle_specie, n_bin_hist, n_distribution ),    &
                  sum_distr_hadron_full( n_particle_specie, n_bin_hist, n_distribution ),    &
                      distr_parton_partial( n_parton_specie, n_bin_hist, n_distribution ),   &
                  sum_distr_parton_partial( n_parton_specie, n_bin_hist, n_distribution ),   &
                      distr_parton_full( n_parton_specie, n_bin_hist, n_distribution ),      &
                  sum_distr_parton_full( n_parton_specie, n_bin_hist, n_distribution ),      &
                  name_specie( n_particle_specie ), name_parton( n_parton_specie )           &
                )
! For mean pT <pT>.
        allocate( sum_num_h_mean_pT( n_particle_specie, n_partial_and_full ), &
                      num_h_mean_pT( n_particle_specie, n_partial_and_full ), &
                  sum_num_p_mean_pT( n_particle_specie, n_partial_and_full ), &
                      num_p_mean_pT( n_particle_specie, n_partial_and_full )  &
                )
! For flows.
        ! v1, v2, v3 and v4.
        n_y_pT_eta  = 3
        n_flow_type = 4
        allocate( num_h_integral_v( n_particle_specie, n_partial_and_full ),               &
                  flow_h_integral_v( n_particle_specie, n_flow_type, n_partial_and_full ), &
                  dN_h_flow_f( n_bin_hist, n_particle_specie, n_y_pT_eta ), &
                  dN_h_flow( n_bin_hist, n_particle_specie, n_y_pT_eta ),   &
                  dv_h_flow_f( n_bin_hist, n_flow_type, n_particle_specie, n_y_pT_eta ), &
                  dv_h_flow( n_bin_hist, n_flow_type, n_particle_specie, n_y_pT_eta ),   &
                  sum_num_h_integral_v( n_particle_specie, n_partial_and_full ),               &
                  sum_flow_h_integral_v( n_particle_specie, n_flow_type, n_partial_and_full ), &
                  sum_dN_h_flow_f( n_bin_hist, n_particle_specie, n_y_pT_eta ), &
                  sum_dN_h_flow( n_bin_hist, n_particle_specie, n_y_pT_eta ),   &
                  sum_dv_h_flow_f( n_bin_hist, n_flow_type, n_particle_specie, n_y_pT_eta ), &
                  sum_dv_h_flow( n_bin_hist, n_flow_type, n_particle_specie, n_y_pT_eta )    &
                )
        allocate( num_p_integral_v( n_parton_specie, n_partial_and_full ),               &
                  flow_p_integral_v( n_parton_specie, n_flow_type, n_partial_and_full ), &
                  dN_p_flow_f( n_bin_hist, n_parton_specie, n_y_pT_eta ), &
                  dN_p_flow( n_bin_hist, n_parton_specie, n_y_pT_eta ),   &
                  dv_p_flow_f( n_bin_hist, n_flow_type, n_parton_specie, n_y_pT_eta ), &
                  dv_p_flow( n_bin_hist, n_flow_type, n_parton_specie, n_y_pT_eta ),   &
                  sum_num_p_integral_v( n_parton_specie, n_partial_and_full ),               &
                  sum_flow_p_integral_v( n_parton_specie, n_flow_type, n_partial_and_full ), &
                  sum_dN_p_flow_f( n_bin_hist, n_parton_specie, n_y_pT_eta ), &
                  sum_dN_p_flow( n_bin_hist, n_parton_specie, n_y_pT_eta ),   &
                  sum_dv_p_flow_f( n_bin_hist, n_flow_type, n_parton_specie, n_y_pT_eta ), &
                  sum_dv_p_flow( n_bin_hist, n_flow_type, n_parton_specie, n_y_pT_eta )    &
                )

! Initialization.
        comment_line = ""
        name_specie  = ""
        name_parton  = ""
        sum_Ncoll_in_coll_list = 0D0
        sum_Npart_in_coll_list = 0D0
        sum_Ncoll_max_in_coll_list = 0D0
        sum_Ncoll_call_PYTHIA = 0D0
        sum_Ncoll_not_call_PYTHIA = 0D0
        sum_Npart_real = 0D0
        sum_Ncoll_over_Npart_Optical_Glauber_multi_string = 0D0
        sum_Ncoll_optical_Glauber = 0D0
        sum_Npart_call_PYTHIA = 0D0
        sum_Ncoll_nn_call_PYTHIA = 0D0
        sum_Ncoll_pp_call_PYTHIA = 0D0
        sum_Ncoll_np_call_PYTHIA = 0D0
        sum_Ncoll_call_PYTHIA_2 = 0D0
        sum_Ncoll_lp_call_PYTHIA = 0D0
        sum_ave_b_param = 0D0
        sum_avneu = 0D0
        sum_Npart_Optical_Glauber_proj = 0D0
        sum_Npart_Optical_Glauber_targ = 0D0
        sum_Overlap_function_Optical_Glauber = 0D0
        sum_Ncoll_Optical_Glauber_2 = 0D0
        sum_E_gamma_1 = 0D0
        sum_E_gamma_2 = 0D0
        sum_E_gamma_3 = 0D0
        sum_E_gamma_4 = 0D0
        sum_n_coll_parton_rescattering_success = 0D0
        sum_n_coll_parton_rescattering_block = 0D0
        sum_n_coll_parton_rescattering_total = 0D0
        sum_n_process_parton_rescattering = 0D0
        sum_n_coll_hadron_rescattering_elastic = 0D0
        sum_n_coll_hadron_rescattering_inelastic = 0D0
        sum_n_coll_hadron_rescattering_total = 0D0
        sum_parj1_effective = 0D0
        sum_parj2_effective = 0D0
        sum_parj3_effective = 0D0
        sum_parj4_effective = 0D0
        sum_parj21_effective = 0D0
        sum_kapa_effective = 0D0
        sum_n_gluon_in_a_string_single_multi_string = 0D0
        sum_xi_factor_single_string = 0D0
        sum_pT_hardest_gluon_single_string = 0D0
        sum_n_string_single_string = 0D0
        sum_time_NN_collision = 0D0
        sum_time_parton_rescattering = 0D0
        sum_time_hadron_rescattering = 0D0
        sum_n_q_thrown = 0D0
        sum_n_qbar_thrown = 0D0
        sum_charge_thrown = 0D0
        sum_px_thrown = 0D0
        sum_py_thrown = 0D0
        sum_pz_thrown = 0D0
        sum_E_thrown = 0D0
        sum_multiplicity_minus_partial = 0D0
        sum_multiplicity_plus_partial = 0D0
        sum_multiplicity_minus_full = 0D0
        sum_multiplicity_plus_full = 0D0
        sum_multiplicity_specie_partial = 0D0
        sum_multiplicity_specie_full = 0D0
        sum_multiplicity_parton_partial = 0D0
        sum_multiplicity_parton_full = 0D0
        sum_mean_pT_specie_partial = 0D0
        sum_mean_pT_specie_full = 0D0
        sum_mean_pT_parton_partial = 0D0
        sum_mean_pT_parton_full = 0D0
        sum_distr_hadron_partial = 0D0
        sum_distr_hadron_full = 0D0
        sum_distr_parton_partial = 0D0
        sum_distr_parton_full = 0D0
        sum_multiplicity_quark_partial = 0D0
        sum_multiplicity_qbar_partial = 0D0
        sum_multiplicity_gluon_partial = 0D0
        sum_multiplicity_quark_full = 0D0
        sum_multiplicity_qbar_full = 0D0
        sum_multiplicity_gluon_full = 0D0
        sum_n_process_hadron_rescattering = 0D0
        sum_bParam_ANG = 0D0
        sum_sigma_ANG = 0D0
        sum_Ncoll_ANG = 0D0
        sum_Npart_ANG = 0D0
        sum_sigma_NN_tot_parini = 0D0
        sum_sigma_NN_tot_hadcas = 0D0
        max_lost_4mom = 0D0
        ! For mean pT <pT>.
        sum_num_h_mean_pT = 0D0
        sum_num_p_mean_pT = 0D0
        ! For flows.
        sum_num_h_integral_v  = 0D0
        sum_flow_h_integral_v = 0D0
        sum_dN_h_flow_f = 0D0
        sum_dN_h_flow   = 0D0
        sum_dv_h_flow_f = 0D0
        sum_dv_h_flow   = 0D0
        sum_num_p_integral_v  = 0D0
        sum_flow_p_integral_v = 0D0
        sum_dN_p_flow_f = 0D0
        sum_dN_p_flow   = 0D0
        sum_dv_p_flow_f = 0D0
        sum_dv_p_flow   = 0D0

! Cycles over all of the "../PACIAE_i/rms.out" files.
        loop_file: do i_file=1,n_file,1
            ! Opens one of the "../PACIAE_i/rms.out" files.
            prefix = "../PACIAE_"
            write(infix,*) i_file
            suffix = "/rms.out"
            name_file = TRIM(ADJUSTL(prefix)) // TRIM(ADJUSTL(infix)) // TRIM(ADJUSTL(suffix))
            open( unit=99, file=TRIM(ADJUSTL(name_file)), status="old" )
            ! Records comment line.
            i_line = 0
            ! #!***************************************************************************!#
            ! #!*********************|    PACIAE  Analysis  Output    |********************!#
            ! #!***************************************************************************!#
            !
            ! #! Now is   HH:MM:SS   DD/MM/YYYY
            ! #! Current version: PACIAE x.yyy  +  PYTHIA 6.428  + PYTHIA 8.yyy
            ! #! Seed (PACIAE default=20240116) = *********
            ! #! Collision system        : ***
            ! #! Simulation mode: ***
            ! #! Nuclear shadowing: ***
            ! #! Tune: ***
            ! #! Subprocess: ***
            ! #! Color reconnection: ***
            ! #! Hadronization: ***
            ! #! Partonic rescattering: ***
            ! #! Hadronic rescattering: ***
            !
            do j=1,17,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! #!-----------------------------------------------------------------------------
            ! #! Number of events = ***
            do j=1,2,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) n_event_per_file
                n_event_total = n_event_total + n_event_per_file
            ! #! NN(pp) total cross section in parini (mb) =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) sigma_NN_tot_parini
                sum_sigma_NN_tot_parini = sum_sigma_NN_tot_parini + sigma_NN_tot_parini
            ! #! NN(pp) total cross section in hadcas (mb) =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) sigma_NN_tot_hadcas
                sum_sigma_NN_tot_hadcas = sum_sigma_NN_tot_hadcas + sigma_NN_tot_hadcas
            ! #! MC Glauber-like <N_coll>, <N_part> =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) Ncoll_in_coll_list, Npart_in_coll_list
                sum_Ncoll_in_coll_list = sum_Ncoll_in_coll_list + Ncoll_in_coll_list
                sum_Npart_in_coll_list = sum_Npart_in_coll_list + Npart_in_coll_list
            ! #! largest ave. # of NN collision pairs =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) Ncoll_max_in_coll_list
                sum_Ncoll_max_in_coll_list = sum_Ncoll_max_in_coll_list + Ncoll_max_in_coll_list
            ! #! ave. # of NN collision pairs calling PYTHIA, not calling PYTHIA =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) Ncoll_call_PYTHIA, Ncoll_not_call_PYTHIA
                sum_Ncoll_call_PYTHIA     = sum_Ncoll_call_PYTHIA     + Ncoll_call_PYTHIA
                sum_Ncoll_not_call_PYTHIA = sum_Ncoll_not_call_PYTHIA + Ncoll_not_call_PYTHIA
            ! #! ave. # of wounded nucleons in parini =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) Npart_real
                sum_Npart_real = sum_Npart_real + Npart_real
            ! #! colli. # suffered by projectile nucleon in target nucleus
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) Ncoll_over_Npart_Optical_Glauber_multi_string
                sum_Ncoll_over_Npart_Optical_Glauber_multi_string =   &
                sum_Ncoll_over_Npart_Optical_Glauber_multi_string +   &
                    Ncoll_over_Npart_Optical_Glauber_multi_string
            ! #! event averaged N_bin
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) Ncoll_Optical_Glauber
                sum_Ncoll_Optical_Glauber = sum_Ncoll_Optical_Glauber + Ncoll_Optical_Glauber
            ! #! (Npart)mini-jet, Nnn, Npp=
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) Npart_call_PYTHIA, Ncoll_nn_call_PYTHIA, Ncoll_pp_call_PYTHIA
                sum_Npart_call_PYTHIA    = sum_Npart_call_PYTHIA    + Npart_call_PYTHIA
                sum_Ncoll_nn_call_PYTHIA = sum_Ncoll_nn_call_PYTHIA + Ncoll_nn_call_PYTHIA
                sum_Ncoll_pp_call_PYTHIA = sum_Ncoll_pp_call_PYTHIA + Ncoll_pp_call_PYTHIA
            ! #! Nnp, Ntot, Nep=
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) Ncoll_np_call_PYTHIA, Ncoll_call_PYTHIA_2, Ncoll_lp_call_PYTHIA
                sum_Ncoll_np_call_PYTHIA = sum_Ncoll_np_call_PYTHIA + Ncoll_np_call_PYTHIA
                sum_Ncoll_call_PYTHIA_2  = sum_Ncoll_call_PYTHIA_2  + Ncoll_call_PYTHIA_2
                sum_Ncoll_lp_call_PYTHIA = sum_Ncoll_lp_call_PYTHIA + Ncoll_lp_call_PYTHIA
            ! 2 lines.
            ! For the case of random impact-parameter (b) sampling method.
            if( i_b_sampling_method == 1 ) then
                ! #! event averaged b, avneu, Npart_p, Npart_t, T_pt=
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
                ! Data.
                read(99,*) ave_b_param, avneu,  &
                           Npart_Optical_Glauber_proj, Npart_Optical_Glauber_targ,  &
                           Overlap_function_Optical_Glauber
                    sum_ave_b_param = sum_ave_b_param + ave_b_param
                    sum_avneu = sum_avneu + avneu   !#TODO(Lei20230819): ???
                    sum_Npart_Optical_Glauber_proj = sum_Npart_Optical_Glauber_proj +   &
                                                         Npart_Optical_Glauber_proj
                    sum_Npart_Optical_Glauber_targ = sum_Npart_Optical_Glauber_targ +   &
                                                         Npart_Optical_Glauber_targ
                    sum_Overlap_function_Optical_Glauber =  &
                    sum_Overlap_function_Optical_Glauber +  &
                        Overlap_function_Optical_Glauber
            ! For the case of random impact-parameter (b) sampling method.
            ! else if( i_b_sampling_method == 2 ) then
            else
                ! #! psno, ave. b, Npart_p, Nparp_t and N_bin =
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
                ! Data.
                read(99,*) b_sampling_method, ave_b_param,  &
                           Npart_Optical_Glauber_proj, Npart_Optical_Glauber_targ,  &
                           Ncoll_Optical_Glauber_2
                    sum_ave_b_param = sum_ave_b_param + ave_b_param
                    sum_Npart_Optical_Glauber_proj = sum_Npart_Optical_Glauber_proj +   &
                                                         Npart_Optical_Glauber_proj
                    sum_Npart_Optical_Glauber_targ = sum_Npart_Optical_Glauber_targ +   &
                                                         Npart_Optical_Glauber_targ
                    sum_Ncoll_Optical_Glauber_2 = sum_Ncoll_Optical_Glauber_2 + &
                                                      Ncoll_Optical_Glauber_2
            ! For the case of fixed impact-parameter (b).
            ! else
            !     !
            !     i_line = i_line + 1
            !     read(99,"(A3000)") comment_line( i_line )
            !     !
            !     i_line = i_line + 1
            !     read(99,"(A3000)") comment_line( i_line )
            end if
            ! #!-----------------------------------------------------------------------------
            ! #! Angantyr mode event-averaged output:
            ! #! b, bPhi, bWeight =
            do j=1,3,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) bParam, bPhi, bWeight
                sum_bParam_ANG(1) = sum_bParam_ANG(1) + bParam
                sum_bParam_ANG(2) = sum_bParam_ANG(2) + bPhi
                sum_bParam_ANG(3) = sum_bParam_ANG(3) + bWeight
            ! #! glauberTot, glauberTotErr, glauberND, glauberNDErr (mb) =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) glauberTot, glauberTotErr, glauberND, glauberNDErr
                sum_sigma_ANG(1,1) = sum_sigma_ANG(1,1) + glauberTot
                sum_sigma_ANG(1,2) = sum_sigma_ANG(1,2) + glauberTotErr
                sum_sigma_ANG(2,1) = sum_sigma_ANG(2,1) + glauberND
                sum_sigma_ANG(2,2) = sum_sigma_ANG(2,2) + glauberNDErr
            ! #! glauberINEL, glauberINELErr, glauberEL, glauberELErr (mb) =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) glauberINEL, glauberINELErr, glauberEL, glauberELErr
                sum_sigma_ANG(3,1) = sum_sigma_ANG(3,1) + glauberINEL
                sum_sigma_ANG(3,2) = sum_sigma_ANG(3,2) + glauberINELErr
                sum_sigma_ANG(4,1) = sum_sigma_ANG(4,1) + glauberEL
                sum_sigma_ANG(4,2) = sum_sigma_ANG(4,2) + glauberELErr
            ! #! glauberDiffP, glauberDiffPErr, glauberDiffT, glauberDiffTErr (mb) =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) glauberDiffP, glauberDiffPErr, glauberDiffT, glauberDiffTErr
                sum_sigma_ANG(5,1) = sum_sigma_ANG(5,1) + glauberDiffP
                sum_sigma_ANG(5,2) = sum_sigma_ANG(5,2) + glauberDiffPErr
                sum_sigma_ANG(6,1) = sum_sigma_ANG(6,1) + glauberDiffT
                sum_sigma_ANG(6,2) = sum_sigma_ANG(6,2) + glauberDiffTErr
            ! #! glauberDDiff, glauberDDiffErr (mb), glauberBSlope, glauberBSlopeErr (mb) =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) glauberDDiff, glauberDDiffErr, glauberBSlope, glauberBSlopeErr
                sum_sigma_ANG(7,1) = sum_sigma_ANG(7,1) + glauberDDiff
                sum_sigma_ANG(7,2) = sum_sigma_ANG(7,2) + glauberDDiffErr
                sum_sigma_ANG(8,1) = sum_sigma_ANG(8,1) + glauberBSlope
                sum_sigma_ANG(8,2) = sum_sigma_ANG(8,2) + glauberBSlopeErr
            ! #! nCollND, nCollSDP, nCollSDT =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) nCollTot, nCollND, nCollSDP, nCollSDT
                sum_Ncoll_ANG(1) = sum_Ncoll_ANG(1) + nCollTot
                sum_Ncoll_ANG(2) = sum_Ncoll_ANG(2) + nCollND
                sum_Ncoll_ANG(3) = sum_Ncoll_ANG(3) + nCollSDP
                sum_Ncoll_ANG(4) = sum_Ncoll_ANG(4) + nCollSDT
            ! #! nCollDD, nCollCD, nCollEl, nCollTot =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) nCollDD, nCollCD, nCollEl
                sum_Ncoll_ANG(5) = sum_Ncoll_ANG(5) + nCollDD
                sum_Ncoll_ANG(6) = sum_Ncoll_ANG(6) + nCollCD
                sum_Ncoll_ANG(7) = sum_Ncoll_ANG(7) + nCollEl
            ! #! nPartProj, nAbsProj, nDiffProj, nElProj =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) nPartProj, nAbsProj, nDiffProj, nElProj
                sum_Npart_ANG(1,1) = sum_Npart_ANG(1,1) + nPartProj
                sum_Npart_ANG(2,1) = sum_Npart_ANG(2,1) + nAbsProj
                sum_Npart_ANG(3,1) = sum_Npart_ANG(3,1) + nDiffProj
                sum_Npart_ANG(4,1) = sum_Npart_ANG(4,1) + nElProj
            ! #! nPartTarg, nAbsTarg, nDiffTarg, nElTarg =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) nPartTarg, nAbsTarg, nDiffTarg, nElTarg
                sum_Npart_ANG(1,2) = sum_Npart_ANG(1,2) + nPartTarg
                sum_Npart_ANG(2,2) = sum_Npart_ANG(2,2) + nAbsTarg
                sum_Npart_ANG(3,2) = sum_Npart_ANG(3,2) + nDiffTarg
                sum_Npart_ANG(4,2) = sum_Npart_ANG(4,2) + nElTarg
            ! #!-----------------------------------------------------------------------------
            ! #! event averaged energy of gamma after partonic initiation, partonic cascade,
            ! #!  hadronization and end of event =
            do j=1,3,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) E_gamma_1, E_gamma_2, E_gamma_3, E_gamma_4
                sum_E_gamma_1 = sum_E_gamma_1 + E_gamma_1
                sum_E_gamma_2 = sum_E_gamma_2 + E_gamma_2
                sum_E_gamma_3 = sum_E_gamma_3 + E_gamma_3
                sum_E_gamma_4 = sum_E_gamma_4 + E_gamma_4
            ! #!-----------------------------------------------------------------------------
            ! #! # of successful, blocked and all collision in parton cascade =
            do j=1,2,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) n_coll_parton_rescattering_success,  &
                       n_coll_parton_rescattering_block,    &
                       n_coll_parton_rescattering_total
                sum_n_coll_parton_rescattering_success =    &
                sum_n_coll_parton_rescattering_success +    &
                    n_coll_parton_rescattering_success
                sum_n_coll_parton_rescattering_block =  &
                sum_n_coll_parton_rescattering_block +  &
                    n_coll_parton_rescattering_block
                sum_n_coll_parton_rescattering_total =  &
                sum_n_coll_parton_rescattering_total +  &
                    n_coll_parton_rescattering_total
            ! #! average collision # in parton cascade =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) n_coll_parton_rescattering
                sum_n_coll_parton_rescattering = sum_n_coll_parton_rescattering +   &
                                                     n_coll_parton_rescattering
            ! #! # of scaterring processes in parton cascade
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! #! q1 + q2 -> q1 + q2     q1 + q1 -> q1 + q1      q1 + q2bar -> q1 + q2bar    q1 + q1bar -> q2 + q2bar    q1 + q1bar -> q1 + q1bar
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( n_process_parton_rescattering(k), k=1,5,1 )
            ! #! q1 + q1bar -> g + g    g + g -> q1 + q1bar     q1 + g -> q1 + g            g + g -> g + g              Q + q -> Q + q
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( n_process_parton_rescattering(k), k=6,10,1 )
            ! #! Q + g -> Q + g         q + qbar -> Q + Qbar    g + g -> Q + Qbar           Q + Qbar -> q + qbar        Q + Qbar -> g + g
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( n_process_parton_rescattering(k), k=11,15,1 )
                sum_n_process_parton_rescattering = sum_n_process_parton_rescattering +    &
                                                        n_process_parton_rescattering
            ! #! average frequency of the occurring of each inela. in hadron cascade (at the end of the file)
            ! #! el. and inel. coll. # and sum in hadron cascade=
            do j=1,2,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) n_coll_hadron_rescattering_elastic,     &
                       n_coll_hadron_rescattering_inelastic,   &
                       n_coll_hadron_rescattering_total
                   sum_n_coll_hadron_rescattering_elastic =    &
                   sum_n_coll_hadron_rescattering_elastic +    &
                       n_coll_hadron_rescattering_elastic
                   sum_n_coll_hadron_rescattering_inelastic =  &
                   sum_n_coll_hadron_rescattering_inelastic +  &
                       n_coll_hadron_rescattering_inelastic
                   sum_n_coll_hadron_rescattering_total =  &
                   sum_n_coll_hadron_rescattering_total +  &
                       n_coll_hadron_rescattering_total
            ! #!-----------------------------------------------------------------------------
            ! #! default parj1, parj2, parj3, parj4, parj21 =
            do j=1,2,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) parj1_default, parj2_default, parj3_default, parj4_default, parj21_default
            ! #! Eff-parj1, parj2, parj3, parj4, parj21, keff =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data
            read(99,*) parj1_effective, parj2_effective, parj3_effective,   &
                       parj4_effective, parj21_effective, kapa_effective
                sum_parj1_effective = sum_parj1_effective + parj1_effective
                sum_parj2_effective = sum_parj2_effective + parj2_effective
                sum_parj3_effective = sum_parj3_effective + parj3_effective
                sum_parj4_effective = sum_parj4_effective + parj4_effective
                sum_parj21_effective = sum_parj21_effective + parj21_effective
                sum_kapa_effective = sum_kapa_effective + kapa_effective
            ! #! averaged # of gluon in a string when kjp22=1,3
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) n_gluon_in_a_string_single_multi_string
                sum_n_gluon_in_a_string_single_multi_string =   &
                sum_n_gluon_in_a_string_single_multi_string +   &
                    n_gluon_in_a_string_single_multi_string
            ! #! event averaged value of the factor related to # 
            ! #!  of gluons and hardest gluon in a string, event 
            ! #!  averaged transverse momentum of hardest gluon,
            ! #!  event averaged # strings when kjp22=1,3 =
            do j=1,4,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data
            read(99,*) xi_factor_single_string, pT_hardest_gluon_single_string, n_string_single_string
                sum_xi_factor_single_string = sum_xi_factor_single_string + &
                                                  xi_factor_single_string
                sum_pT_hardest_gluon_single_string = sum_pT_hardest_gluon_single_string +   &
                                                         pT_hardest_gluon_single_string
                sum_n_string_single_string = sum_n_string_single_string +   &
                                                 n_string_single_string
            ! #!-----------------------------------------------------------------------------
            ! #! times & sum =
            do j=1,2,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) time_NN_collision, time_parton_rescattering, time_hadron_rescattering
                sum_time_NN_collision = sum_time_NN_collision + time_NN_collision
                sum_time_parton_rescattering = sum_time_parton_rescattering + time_parton_rescattering
                sum_time_hadron_rescattering = sum_time_hadron_rescattering + time_hadron_rescattering
            ! #!-----------------------------------------------------------------------------
            ! #! q, qbar, charge thrown away =
            do j=1,2,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) n_q_thrown, n_qbar_thrown, charge_thrown
                sum_n_q_thrown    = sum_n_q_thrown    + n_q_thrown
                sum_n_qbar_thrown = sum_n_qbar_thrown + n_qbar_thrown
                sum_charge_thrown = sum_charge_thrown + charge_thrown
            ! #! 3-momentum and energy thrown away =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) px_thrown, py_thrown, pz_thrown, E_thrown
                sum_px_thrown = sum_px_thrown + px_thrown
                sum_py_thrown = sum_py_thrown + py_thrown
                sum_pz_thrown = sum_pz_thrown + pz_thrown
                sum_E_thrown  = sum_E_thrown  + E_thrown
            ! #! Max 3-momentum and energy thrown away =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) max_lost_4mom0
                do j=1,4,1
                    if( ABS( max_lost_4mom0(j) ) > ABS( max_lost_4mom(j) ) ) &
                        max_lost_4mom(j) = max_lost_4mom0(j)
                end do

!==============================================================================!
! Reads out the multiplicity and mean pT of hadrons in the partial and full 
!   phase-spaces.
!==============================================================================!
            ! For hadrons:
            !
            ! #!-----------------------------------------------------------------------------
            ! #! multiplicity of negative, positive particles and sums, partial & full =
            do j=1,3,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) multiplicity_minus_partial, multiplicity_plus_partial, multiplicity_total_partial
            ! Data.
            read(99,*) multiplicity_minus_full, multiplicity_plus_full, multiplicity_total_full
                sum_multiplicity_minus_partial = sum_multiplicity_minus_partial + multiplicity_minus_partial
                sum_multiplicity_plus_partial  = sum_multiplicity_plus_partial  + multiplicity_plus_partial
                sum_multiplicity_minus_full    = sum_multiplicity_minus_full    + multiplicity_minus_full
                sum_multiplicity_plus_full     = sum_multiplicity_plus_full     + multiplicity_plus_full
            ! #!-----------------------------------------------------------------------------
            ! #! particle multiplicity, partial =
            ! #! tatol charged  pi+K+p name_1 ... name_20
            do j=1,3,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) ( multiplicity_specie_partial(j), j=1,n_particle_specie,1 )
                sum_multiplicity_specie_partial = sum_multiplicity_specie_partial + multiplicity_specie_partial
            ! #! particle multiplicity, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( multiplicity_specie_full(j), j=1,n_particle_specie,1 )
                sum_multiplicity_specie_full = sum_multiplicity_specie_full + multiplicity_specie_full
            ! #!-----------------------------------------------------------------------------
            ! #! Number of particles for mean pT <pT>, partial =
            do j=1,2,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) ( num_h_mean_pT(j,1), j=1,n_particle_specie,1 )
            ! #! Number of particles for mean pT <pT>, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( num_h_mean_pT(j,2), j=1,n_particle_specie,1 )
                sum_num_h_mean_pT = sum_num_h_mean_pT + num_h_mean_pT
            ! #! Total pT of particles, partial =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( mean_pT_specie_partial(j), j=1,n_particle_specie,1 )
                sum_mean_pT_specie_partial = sum_mean_pT_specie_partial + mean_pT_specie_partial
            ! #! Total pT of particles, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( mean_pT_specie_full(j), j=1,n_particle_specie,1 )
                sum_mean_pT_specie_full = sum_mean_pT_specie_full + mean_pT_specie_full
            ! #! particle mean pT <pT>, partial =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*)
            ! #! particle mean pT <pT>, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*)

!==============================================================================!
! Reads out flows of hadrons in the partial and full phase-spaces.
!==============================================================================!
            ! #!-----------------------------------------------------------------------------
            ! #! Number of particles for integtral flows, partial =
            do j=1,2,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) ( num_h_integral_v(j,1), j=1,n_particle_specie,1 )
            ! #! Number of particles for integtral flows, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( num_h_integral_v(j,2), j=1,n_particle_specie,1 )
                sum_num_h_integral_v = sum_num_h_integral_v + num_h_integral_v
            ! #! Total integral flows, v1, v2, v3, v4, partial =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            do i = 1, n_flow_type, 1
                read(99,*) ( flow_h_integral_v(j,i,1), j=1,n_particle_specie,1 )
            end do
            ! #! Total integral flows, v1, v2, v3, v4, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            do i = 1, n_flow_type, 1
                read(99,*) ( flow_h_integral_v(j,i,2), j=1,n_particle_specie,1 )
            end do
                sum_flow_h_integral_v = sum_flow_h_integral_v + flow_h_integral_v
            ! #! Particle number averaged integral flows, v1, v2, v3, v4, partial =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            do i = 1, n_flow_type, 1
                read(99,*)
            end do
            ! #! Particle number averaged integral flows, v1, v2, v3, v4, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            do i = 1, n_flow_type, 1
                read(99,*)
            end do
            !
            !
            !
            do j=1,3,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do

!==============================================================================!
! Reads out the data of "n_distribution" distributions for hadrons in the 
!   partial and full phase-spaces.
!==============================================================================!
            ! For hadrons:
            ! #!*******************|    Hadron  Distribution  Output    |******************!#
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            distr_hadron_partial = 0D0
            distr_hadron_full    = 0D0
            loop_hadron: do i_distr=1,n_distribution,1
                ! '8' distributions are used for '7', i.e. mean <pT>.
                if( i_distr == 8 ) cycle
                ! Partial phase-space.
                ! #!-----------------------------------------------------------------------------
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
                ! #! ID of distribution m2=           x    xxxx              
                ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                ! #! x    total  charged  pi+K+p  name_1 ... name_20
                do j=1,3,1
                    i_line = i_line + 1
                    read(99,"(A3000)") comment_line( i_line )
                end do
                ! Reads out the data of partial phase-space.
                do i_bin=1,n_bin_hist,1
                    read(99,*) x_coor(i_bin,i_distr),   &
                    ( distr_hadron_partial(i_specie,i_bin,i_distr), i_specie=1,n_particle_specie,1 )
                end do
                ! Full phase-space.
                ! #! ID of distribution m2=           x    xxxx              
                ! #! full phase-space
                ! #! x    total  charged  pi+K+p  name_1 ... name_20
                do j=1,3,1
                    i_line = i_line + 1
                    read(99,"(A3000)") comment_line( i_line )
                end do
                ! Reads out the data of full phase-space.
                do i_bin=1,n_bin_hist,1
                    read(99,*) x_coor(i_bin,i_distr),   &
                        ( distr_hadron_full(i_specie,i_bin,i_distr), i_specie=1,n_particle_specie,1 )
                end do
                ! For mean pT <pT>.
                if( i_distr /= 7 ) cycle
                do i_distr2 = 8, 7, -1
                    ! #! Num of particles for mean pT / Total pT
                    ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                    ! #! x    total  charged  pi+K+p  name_1 ... name_20
                    do j=1,3,1
                        i_line = i_line + 1
                        read(99,"(A3000)") comment_line( i_line )
                    end do
                    ! Data.
                    do i_bin=1,n_bin_hist,1
                        read(99,*) x_mean_pT,   &
                        ( distr_hadron_partial( i_specie, i_bin, i_distr2 ), i_specie=1,n_particle_specie,1 )
                    end do
                    ! #! Num of particles for mean pT / Total pT
                    ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                    ! #! x    total  charged  pi+K+p  name_1 ... name_20
                    do j=1,3,1
                        i_line = i_line + 1
                        read(99,"(A3000)") comment_line( i_line )
                    end do
                    ! Data.
                    do i_bin=1,n_bin_hist,1
                        read(99,*) x_mean_pT,   &
                            ( distr_hadron_full( i_specie, i_bin, i_distr2 ), i_specie=1,n_particle_specie,1 )
                    end do
                end do
            end do loop_hadron
            sum_distr_hadron_partial = sum_distr_hadron_partial + distr_hadron_partial
            sum_distr_hadron_full    = sum_distr_hadron_full    + distr_hadron_full
            !
            !
            !
            do j=1,3,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do

!==============================================================================!
! Reads out the data of flows for hadrons in the 
!   partial and full phase-spaces.
!==============================================================================!
            ! For hadrons:
            ! #!***********************|    Hadron  Flow  Output    |**********************!#
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Ave. flows.
            do i_y_pT_eta = 1, n_y_pT_eta, 1
                do i_flow = 1, n_flow_type, 1
                    ! Partial phase-space.
                    ! #!-----------------------------------------------------------------------------
                    i_line = i_line + 1
                    read(99,"(A3000)") comment_line( i_line )
                    ! #! Particle number ave. xxx flow, v_i VS. ?
                    ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                    ! #! x    total  charged  pi+K+p  name_1 ... name_20
                    do j=1,3,1
                        i_line = i_line + 1
                        read(99,"(A3000)") comment_line( i_line )
                    end do
                    ! Jumps over these lines.
                    do i_bin=1,n_bin_hist,1
                        read(99,*)
                    end do
                    ! Full phase-space.
                    ! #! Particle number ave. xxx flow, v_i VS. ?
                    ! #! full phase-space
                    ! #! x    total  charged  pi+K+p  name_1 ... name_20
                    do j=1,3,1
                        i_line = i_line + 1
                        read(99,"(A3000)") comment_line( i_line )
                    end do
                    ! Jumps over these lines.
                    do i_bin=1,n_bin_hist,1
                        read(99,*)
                    end do
                end do
            end do
            ! Num of particles.
                dN_h_flow   = 0D0
                dN_h_flow_f = 0D0
            do i_y_pT_eta = 1, n_y_pT_eta, 1
                ! Partial phase-space.
                ! #!-----------------------------------------------------------------------------
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
                ! #! Num of particles for diff. flows, N VS. ?
                ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                ! #! x    total  charged  pi+K+p  name_1 ... name_20
                do j=1,3,1
                    i_line = i_line + 1
                    read(99,"(A3000)") comment_line( i_line )
                end do
                ! Reads out the data of partial phase-space.
                do i_bin=1,n_bin_hist,1
                    read(99,*) x_flow, &
                    ( dN_h_flow( i_bin, i_specie, i_y_pT_eta ), i_specie=1,n_particle_specie,1 )
                end do
                ! Full phase-space.
                ! #! Num of particles for diff. flows, N VS. y
                ! #! full phase-space
                ! #! x    total  charged  pi+K+p  name_1 ... name_20
                do j=1,3,1
                    i_line = i_line + 1
                    read(99,"(A3000)") comment_line( i_line )
                end do
                ! Reads out the data of full phase-space.
                do i_bin=1,n_bin_hist,1
                    read(99,*) x_flow, &
                    ( dN_h_flow_f( i_bin, i_specie, i_y_pT_eta ), i_specie=1,n_particle_specie,1 )
                end do
            end do
                sum_dN_h_flow   = sum_dN_h_flow   + dN_h_flow
                sum_dN_h_flow_f = sum_dN_h_flow_f + dN_h_flow_f
            ! Total flows.
                dv_h_flow   = 0D0
                dv_h_flow_f = 0D0
            do i_y_pT_eta = 1, n_y_pT_eta, 1
                do i_flow = 1, n_flow_type, 1
                    ! Partial phase-space.
                    ! #!-----------------------------------------------------------------------------
                    i_line = i_line + 1
                    read(99,"(A3000)") comment_line( i_line )
                    ! #! Total xxx flow, v_i VS. ?
                    ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                    ! #! x    total  charged  pi+K+p  name_1 ... name_20
                    do j=1,3,1
                        i_line = i_line + 1
                        read(99,"(A3000)") comment_line( i_line )
                    end do
                    ! Reads out the data of partial phase-space.
                    do i_bin=1,n_bin_hist,1
                        read(99,*) x_flow, &
                        ( dv_h_flow( i_bin, i_flow, i_specie, i_y_pT_eta ), i_specie=1,n_particle_specie,1 )
                    end do
                    ! Full phase-space.
                    ! #! Total xxx flow, v_i VS. ?
                    ! #! full phase-space
                    ! #! x    total  charged  pi+K+p  name_1 ... name_20
                    do j=1,3,1
                        i_line = i_line + 1
                        read(99,"(A3000)") comment_line( i_line )
                    end do
                    ! Reads out the data of full phase-space.
                    do i_bin=1,n_bin_hist,1
                        read(99,*) x_flow, &
                        ( dv_h_flow_f( i_bin, i_flow, i_specie, i_y_pT_eta ), i_specie=1,n_particle_specie,1 )
                    end do
                end do
            end do
                sum_dv_h_flow   = sum_dv_h_flow   + dv_h_flow
                sum_dv_h_flow_f = sum_dv_h_flow_f + dv_h_flow_f
            !
            !
            !
            do j=1,3,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do

!==============================================================================!
! Reads out the multiplicity and mean pT of partons in the partial and full 
!   phase-spaces.
!==============================================================================!
            ! For partons:
            ! #!-----------------------------------------------------------------------------
            ! #! multiplicity of negative, positive quark, sums and gluon, partial & full =
            do j=1,2,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) multiplicity_quark_partial, multiplicity_qbar_partial,   &
                       multiplicity_q_qbar_total_partial, multiplicity_gluon_partial
            ! Data.
            read(99,*) multiplicity_quark_full, multiplicity_qbar_full,     &
                       multiplicity_q_qbar_total_full, multiplicity_gluon_full
                sum_multiplicity_quark_partial = sum_multiplicity_quark_partial + multiplicity_quark_partial
                sum_multiplicity_qbar_partial  = sum_multiplicity_qbar_partial  + multiplicity_qbar_partial
                sum_multiplicity_gluon_partial = sum_multiplicity_gluon_partial + multiplicity_gluon_partial
                sum_multiplicity_quark_full    = sum_multiplicity_quark_full    + multiplicity_quark_full
                sum_multiplicity_qbar_full     = sum_multiplicity_qbar_full     + multiplicity_qbar_full
                sum_multiplicity_gluon_full    = sum_multiplicity_gluon_full    + multiplicity_gluon_full
            ! #!-----------------------------------------------------------------------------
            ! #! particle multiplicity, partial =
            ! #! g      u+d+s + anti- ... u, d, s, ...
            do j=1,3,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) ( multiplicity_parton_partial(j), j=1,n_parton_specie,1 )
                sum_multiplicity_parton_partial = sum_multiplicity_parton_partial + multiplicity_parton_partial
            ! #! particle multiplicity, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( multiplicity_parton_full(j), j=1,n_parton_specie,1 )
                sum_multiplicity_parton_full = sum_multiplicity_parton_full + multiplicity_parton_full
            ! #!-----------------------------------------------------------------------------
            ! #! Number of particles for mean pT <pT>, partial =
            do j=1,2,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) ( num_p_mean_pT(j,1), j=1,n_parton_specie,1 )
            ! #! Number of particles for mean pT <pT>, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( num_p_mean_pT(j,2), j=1,n_parton_specie,1 )
                sum_num_p_mean_pT = sum_num_p_mean_pT + num_p_mean_pT
            ! #! Total pT of particles, partial =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( mean_pT_parton_partial(j), j=1,n_parton_specie,1 )
                sum_mean_pT_parton_partial = sum_mean_pT_parton_partial + mean_pT_parton_partial
            ! #! Total pT of particles, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( mean_pT_parton_full(j), j=1,n_parton_specie,1 )
                sum_mean_pT_parton_full = sum_mean_pT_parton_full + mean_pT_parton_full
            ! #! particle mean pT <pT>, partial =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*)
            ! #! particle mean pT <pT>, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*)

!==============================================================================!
! Reads out flows of partons in the partial and full phase-spaces.
!==============================================================================!
            ! #!-----------------------------------------------------------------------------
            ! #! Number of particles for integtral flows, partial =
            do j=1,2,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do
            ! Data.
            read(99,*) ( num_p_integral_v(j,1), j=1,n_parton_specie,1 )
            ! #! Number of particles for integtral flows, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            read(99,*) ( num_p_integral_v(j,2), j=1,n_parton_specie,1 )
                sum_num_p_integral_v = sum_num_p_integral_v + num_p_integral_v
            ! #! Total integral flows, v1, v2, v3, v4, partial =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            do i = 1, n_flow_type, 1
                read(99,*) ( flow_p_integral_v(j,i,1), j=1,n_parton_specie,1 )
            end do
            ! #! Total integral flows, v1, v2, v3, v4, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            do i = 1, n_flow_type, 1
                read(99,*) ( flow_p_integral_v(j,i,2), j=1,n_parton_specie,1 )
            end do
                sum_flow_p_integral_v = sum_flow_p_integral_v + flow_p_integral_v
            ! #! Particle number averaged integral flows, v1, v2, v3, v4, partial =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            do i = 1, n_flow_type, 1
                read(99,*)
            end do
            ! #! Particle number averaged integral flows, v1, v2, v3, v4, full =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Data.
            do i = 1, n_flow_type, 1
                read(99,*)
            end do
            !
            !
            !
            do j=1,3,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do

!==============================================================================!
! Reads out the data of "n_distribution" distributions for partons in the 
!   partial and full phase-spaces.
!==============================================================================!
            ! For partons:
            ! #!*******************|    Parton  Distribution  Output    |******************!#
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            distr_parton_partial = 0D0
            distr_parton_full    = 0D0
            loop_parton: do i_distr=1,n_distribution,1
                ! '8' distributions are used for '7', i.e. mean <pT>.
                if( i_distr == 8 ) cycle
                ! Partial phase-space.
                ! #!-----------------------------------------------------------------------------
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
                ! #! ID of distribution m2=           x    xxxx              
                ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                ! #! x    g     u+d+s + anti-   u, d, s, ...
                do j=1,3,1
                    i_line = i_line + 1
                    read(99,"(A3000)") comment_line( i_line )
                end do
                ! Reads out data of partial phase-space.
                do i_bin=1,n_bin_hist,1
                    read(99,*) x_coor(i_bin,i_distr),   &
                        ( distr_parton_partial(i_specie,i_bin,i_distr), i_specie=1,n_parton_specie,1 )
                end do
                ! Full phase-space.
                ! #! ID of distribution m2=           x    xxxx              
                ! #! full phase-space
                ! #! x    g     u+d+s + anti-   u, d, s, ...
                do j=1,3,1
                    i_line = i_line + 1
                    read(99,"(A3000)") comment_line( i_line )
                end do
                ! Reads out data of full phase-space.
                do i_bin=1,n_bin_hist,1
                    read(99,*) x_coor(i_bin,i_distr),   &
                        ( distr_parton_full(i_specie,i_bin,i_distr), i_specie=1,n_parton_specie,1 )
                end do
                ! For mean pT <pT>.
                if( i_distr /= 7 ) cycle
                do i_distr2 = 8, 7, -1
                    ! #! Num of particles for mean pT / Total pT
                    ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                    ! #! x    g     u+d+s + anti-   u, d, s, ...
                    do j=1,3,1
                        i_line = i_line + 1
                        read(99,"(A3000)") comment_line( i_line )
                    end do
                    ! Data.
                    do i_bin=1,n_bin_hist,1
                        read(99,*) x_mean_pT,   &
                        ( distr_parton_partial( i_specie, i_bin, i_distr2 ), i_specie=1,n_parton_specie,1 )
                    end do
                    ! #! Num of particles for mean pT / Total pT
                    ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                    ! #! x    g     u+d+s + anti-   u, d, s, ...
                    do j=1,3,1
                        i_line = i_line + 1
                        read(99,"(A3000)") comment_line( i_line )
                    end do
                    ! Data.
                    do i_bin=1,n_bin_hist,1
                        read(99,*) x_mean_pT,   &
                            ( distr_parton_full( i_specie, i_bin, i_distr2 ), i_specie=1,n_parton_specie,1 )
                    end do
                end do
            end do loop_parton
            sum_distr_parton_partial = sum_distr_parton_partial + distr_parton_partial
            sum_distr_parton_full    = sum_distr_parton_full    + distr_parton_full
            !
            !
            !
            do j=1,3,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do

!==============================================================================!
! Reads out the data of flows for partons in the 
!   partial and full phase-spaces.
!==============================================================================!
            ! For partons:
            ! #!***********************|    Parton  Flow  Output    |**********************!#
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Ave. flows.
            do i_y_pT_eta = 1, n_y_pT_eta, 1
                do i_flow = 1, n_flow_type, 1
                    ! Partial phase-space.
                    ! #!-----------------------------------------------------------------------------
                    i_line = i_line + 1
                    read(99,"(A3000)") comment_line( i_line )
                    ! #! Particle number ave. xxx flow, v_i VS. ?
                    ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                    ! #! x    g     u+d+s + anti-   u, d, s, ...
                    do j=1,3,1
                        i_line = i_line + 1
                        read(99,"(A3000)") comment_line( i_line )
                    end do
                    ! Jumps over these lines.
                    do i_bin=1,n_bin_hist,1
                        read(99,*)
                    end do
                    ! Full phase-space.
                    ! #! Particle number ave. xxx flow, v_i VS. ?
                    ! #! full phase-space
                    ! #! x    g     u+d+s + anti-   u, d, s, ...
                    do j=1,3,1
                        i_line = i_line + 1
                        read(99,"(A3000)") comment_line( i_line )
                    end do
                    ! Jumps over these lines.
                    do i_bin=1,n_bin_hist,1
                        read(99,*)
                    end do
                end do
            end do
            ! Num of particles.
                dN_p_flow   = 0D0
                dN_p_flow_f = 0D0
            do i_y_pT_eta = 1, n_y_pT_eta, 1
                ! Partial phase-space.
                ! #!-----------------------------------------------------------------------------
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
                ! #! Num of particles for diff. flows, N VS. ?
                ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                ! #! x    g     u+d+s + anti-   u, d, s, ...
                do j=1,3,1
                    i_line = i_line + 1
                    read(99,"(A3000)") comment_line( i_line )
                end do
                ! Reads out the data of partial phase-space.
                do i_bin=1,n_bin_hist,1
                    read(99,*) x_flow, &
                    ( dN_p_flow( i_bin, i_specie, i_y_pT_eta ), i_specie=1,n_parton_specie,1 )
                end do
                ! Full phase-space.
                ! #! Num of particles for diff. flows, N VS. y
                ! #! full phase-space
                ! #! x    g     u+d+s + anti-   u, d, s, ...
                do j=1,3,1
                    i_line = i_line + 1
                    read(99,"(A3000)") comment_line( i_line )
                end do
                ! Reads out the data of full phase-space.
                do i_bin=1,n_bin_hist,1
                    read(99,*) x_flow, &
                    ( dN_p_flow_f( i_bin, i_specie, i_y_pT_eta ), i_specie=1,n_parton_specie,1 )
                end do
            end do
                sum_dN_p_flow   = sum_dN_p_flow   + dN_p_flow
                sum_dN_p_flow_f = sum_dN_p_flow_f + dN_p_flow_f
            ! Total flows.
                dv_p_flow   = 0D0
                dv_p_flow_f = 0D0
            do i_y_pT_eta = 1, 3, 1
                do i_flow = 1, n_flow_type, 1
                    ! Partial phase-space.
                    ! #!-----------------------------------------------------------------------------
                    i_line = i_line + 1
                    read(99,"(A3000)") comment_line( i_line )
                    ! #! Total xxx flow, v_i VS. ?
                    ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                    ! #! x    total  charged  pi+K+p  name_1 ... name_20
                    do j=1,3,1
                        i_line = i_line + 1
                        read(99,"(A3000)") comment_line( i_line )
                    end do
                    ! Reads out the data of partial phase-space.
                    do i_bin=1,n_bin_hist,1
                        read(99,*) x_flow, &
                        ( dv_p_flow( i_bin, i_flow, i_specie, i_y_pT_eta ), i_specie=1,n_parton_specie,1 )
                    end do
                    ! Full phase-space.
                    ! #! Total xxx flow, v_i VS. ?
                    ! #! full phase-space
                    ! #! x    total  charged  pi+K+p  name_1 ... name_20
                    do j=1,3,1
                        i_line = i_line + 1
                        read(99,"(A3000)") comment_line( i_line )
                    end do
                    ! Reads out the data of full phase-space.
                    do i_bin=1,n_bin_hist,1
                        read(99,*) x_flow, &
                        ( dv_p_flow_f( i_bin, i_flow, i_specie, i_y_pT_eta ), i_specie=1,n_parton_specie,1 )
                    end do
                end do
            end do
                sum_dv_p_flow   = sum_dv_p_flow   + dv_p_flow
                sum_dv_p_flow_f = sum_dv_p_flow_f + dv_p_flow_f
            !
            !
            !
            do j=1,3,1
                i_line = i_line + 1
                read(99,"(A3000)") comment_line( i_line )
            end do

!==============================================================================!
! Reads out the frequency of the occurring of each inela. in hadron cascade.
!==============================================================================!
            ! #! average frequency of the occurring of each inela. in hadron cascade =
            i_line = i_line + 1
            read(99,"(A3000)") comment_line( i_line )
            ! Reads out data.
            n_process_hadron_rescattering = 0D0
            do j=1,60,1
                read(99,*) ( n_process_hadron_rescattering(k,j), k=1,10,1 )
            end do
            sum_n_process_hadron_rescattering = sum_n_process_hadron_rescattering +     &
                                                    n_process_hadron_rescattering

            close(99)
        end do loop_file

! Event-(file-) averaging.
        sum_sigma_NN_tot_parini = sum_sigma_NN_tot_parini / n_file
        sum_sigma_NN_tot_hadcas = sum_sigma_NN_tot_hadcas / n_file
        sum_Ncoll_in_coll_list = sum_Ncoll_in_coll_list / n_file
        sum_Npart_in_coll_list = sum_Npart_in_coll_list / n_file
        sum_Ncoll_max_in_coll_list = sum_Ncoll_max_in_coll_list / n_file
        sum_Ncoll_call_PYTHIA = sum_Ncoll_call_PYTHIA / n_file
        sum_Ncoll_not_call_PYTHIA = sum_Ncoll_not_call_PYTHIA / n_file
        sum_Npart_real = sum_Npart_real / n_file
        sum_Ncoll_over_Npart_Optical_Glauber_multi_string =     &
            sum_Ncoll_over_Npart_Optical_Glauber_multi_string / n_file
        sum_Ncoll_Optical_Glauber = sum_Ncoll_Optical_Glauber / n_file
        sum_Npart_call_PYTHIA = sum_Npart_call_PYTHIA / n_file
        sum_Ncoll_nn_call_PYTHIA = sum_Ncoll_nn_call_PYTHIA / n_file
        sum_Ncoll_pp_call_PYTHIA = sum_Ncoll_pp_call_PYTHIA / n_file
        sum_Ncoll_np_call_PYTHIA = sum_Ncoll_np_call_PYTHIA / n_file
        sum_Ncoll_call_PYTHIA_2 = sum_Ncoll_call_PYTHIA_2 / n_file
        sum_Ncoll_lp_call_PYTHIA = sum_Ncoll_lp_call_PYTHIA / n_file
        sum_ave_b_param = sum_ave_b_param / n_file
        sum_avneu = sum_avneu / n_file
        sum_Npart_Optical_Glauber_proj = sum_Npart_Optical_Glauber_proj / n_file
        sum_Npart_Optical_Glauber_targ = sum_Npart_Optical_Glauber_targ / n_file
        sum_Overlap_function_Optical_Glauber =  &
            sum_Overlap_function_Optical_Glauber / n_file
        sum_Ncoll_Optical_Glauber_2 = sum_Ncoll_Optical_Glauber_2 / n_file
        sum_bParam_ANG = sum_bParam_ANG / n_file
        sum_sigma_ANG = sum_sigma_ANG / n_file
        sum_Ncoll_ANG = sum_Ncoll_ANG / n_file
        sum_Npart_ANG = sum_Npart_ANG / n_file
        sum_E_gamma_1 = sum_E_gamma_1 / n_file
        sum_E_gamma_2 = sum_E_gamma_2 / n_file
        sum_E_gamma_3 = sum_E_gamma_3 / n_file
        sum_E_gamma_4 = sum_E_gamma_4 / n_file
        sum_n_coll_parton_rescattering_success = sum_n_coll_parton_rescattering_success / n_file
        sum_n_coll_parton_rescattering_block = sum_n_coll_parton_rescattering_block / n_file
        sum_n_coll_parton_rescattering_total = sum_n_coll_parton_rescattering_total / n_file
        sum_n_coll_parton_rescattering = sum_n_coll_parton_rescattering / n_file
        sum_n_process_parton_rescattering = sum_n_process_parton_rescattering / n_file
        sum_n_coll_hadron_rescattering_elastic = sum_n_coll_hadron_rescattering_elastic / n_file
        sum_n_coll_hadron_rescattering_inelastic = sum_n_coll_hadron_rescattering_inelastic / n_file
        sum_n_coll_hadron_rescattering_total = sum_n_coll_hadron_rescattering_total / n_file
        sum_parj1_effective = sum_parj1_effective / n_file
        sum_parj2_effective = sum_parj2_effective / n_file
        sum_parj3_effective = sum_parj3_effective / n_file
        sum_parj4_effective = sum_parj4_effective / n_file
        sum_parj21_effective = sum_parj21_effective / n_file
        sum_kapa_effective = sum_kapa_effective / n_file
        sum_n_gluon_in_a_string_single_multi_string = sum_n_gluon_in_a_string_single_multi_string / n_file
        sum_xi_factor_single_string = sum_xi_factor_single_string / n_file
        sum_pT_hardest_gluon_single_string = sum_pT_hardest_gluon_single_string / n_file
        sum_n_string_single_string = sum_n_string_single_string / n_file
        sum_time_NN_collision = sum_time_NN_collision / n_file
        sum_time_parton_rescattering = sum_time_parton_rescattering / n_file
        sum_time_hadron_rescattering = sum_time_hadron_rescattering / n_file
        sum_n_q_thrown = sum_n_q_thrown / n_file
        sum_n_qbar_thrown = sum_n_qbar_thrown / n_file
        sum_charge_thrown = sum_charge_thrown / n_file
        sum_px_thrown = sum_px_thrown / n_file
        sum_py_thrown = sum_py_thrown / n_file
        sum_pz_thrown = sum_pz_thrown / n_file
        sum_E_thrown = sum_E_thrown / n_file
        sum_multiplicity_minus_partial = sum_multiplicity_minus_partial / n_file
        sum_multiplicity_plus_partial = sum_multiplicity_plus_partial / n_file
        sum_multiplicity_minus_full = sum_multiplicity_minus_full / n_file
        sum_multiplicity_plus_full = sum_multiplicity_plus_full / n_file
        sum_multiplicity_specie_partial = sum_multiplicity_specie_partial / n_file
        sum_multiplicity_specie_full = sum_multiplicity_specie_full / n_file

        do kk=1,n_distribution,1
            real_n_file = 1D0 * n_file
            if( kk == 7 .OR. kk == 8 ) real_n_file = 1D0
            do jj=1,n_bin_hist,1
                do ii=1,n_particle_specie,1
                    sum_distr_hadron_partial(ii,jj,kk) = sum_distr_hadron_partial(ii,jj,kk) / real_n_file
                    sum_distr_hadron_full(ii,jj,kk)    = sum_distr_hadron_full(ii,jj,kk)    / real_n_file
                end do
            end do
        end do

        sum_multiplicity_quark_partial = sum_multiplicity_quark_partial / n_file
        sum_multiplicity_qbar_partial = sum_multiplicity_qbar_partial / n_file
        sum_multiplicity_gluon_partial = sum_multiplicity_gluon_partial / n_file
        sum_multiplicity_quark_full = sum_multiplicity_quark_full / n_file
        sum_multiplicity_qbar_full = sum_multiplicity_qbar_full / n_file
        sum_multiplicity_gluon_full = sum_multiplicity_gluon_full / n_file
        sum_multiplicity_parton_partial = sum_multiplicity_parton_partial / n_file
        sum_multiplicity_parton_full = sum_multiplicity_parton_full / n_file

        do kk=1,n_distribution,1
            real_n_file = 1D0 * n_file
            if( kk == 7 .OR. kk == 8 ) real_n_file = 1D0
            do jj=1,n_bin_hist,1
                do ii=1,n_parton_specie,1
                    sum_distr_parton_partial(ii,jj,kk) = sum_distr_parton_partial(ii,jj,kk) / real_n_file
                    sum_distr_parton_full(ii,jj,kk)    = sum_distr_parton_full(ii,jj,kk)    / real_n_file
                end do
            end do
        end do

        sum_n_process_hadron_rescattering = sum_n_process_hadron_rescattering / n_file

! Output.
        open( unit=100, file="ave_rms.out", status="unknown" )
        i_line = 0
! Header.
! #!***************************************************************************!#
! #!*********************|    PACIAE  Analysis  Output    |********************!#
! #!***************************************************************************!#
!
        do j=1,4,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Records the current real date and time.
! #! Now is   HH:MM:SS   DD/MM/YYYY
        i_line = i_line + 1
        ! write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        call DATE_AND_TIME(VALUES=n_current_date_and_time)
        do i=1,8,1
            write(c_date_and_time(i),"(I4)") n_current_date_and_time(i)
        enddo
        write(100,*) "#! Now is   " //TRIM(ADJUSTL( c_date_and_time(5) )) //    &
                                ":" //TRIM(ADJUSTL( c_date_and_time(6) )) //    &
                                ":" //TRIM(ADJUSTL( c_date_and_time(7) )) //    &
                              "   " //TRIM(ADJUSTL( c_date_and_time(3) )) //    &
                                "/" //TRIM(ADJUSTL( c_date_and_time(2) )) //    &
                                "/" //TRIM(ADJUSTL( c_date_and_time(1) ))
! #! Current version: PACIAE x.yyy  +  PYTHIA 6.428  + PYTHIA 8.yyy
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! #! Seed (PACIAE default=20240116) = *********
        i_line = i_line + 1
        ! write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        write(100,*) "#! Seed (PACIAE default=20240116) = *********"
! #! Collision system: ***
! #! Simulation mode: ***
! #! Nulear shadowing: ***
! #! Tune: ***
! #! Subprocess: ***
! #! Color recocnection: ***
! #! Hadronization: ***
! #! Partonic rescattering: ***
! #! Hadronic rescattering: ***
!
        do j=1,10,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! #!-----------------------------------------------------------------------------
! #! Number of events = ***
        do j=1,2,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) n_event_total
! #! NN(pp) total cross section in parini (mb) =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_sigma_NN_tot_parini
! #! NN(pp) total cross section in hadcas (mb) =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_sigma_NN_tot_hadcas
! #! MC Glauber-like <N_coll>, <N_part> =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_Ncoll_in_coll_list, sum_Npart_in_coll_list
! #! largest ave. # of NN collision pairs =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_Ncoll_max_in_coll_list
! #! ave. # of NN collision pairs calling PYTHIA, not calling PYTHIA =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_Ncoll_call_PYTHIA, sum_Ncoll_not_call_PYTHIA
! #! ave. # of wounded nucleons in parini =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_Npart_real
! #! colli. # suffered by projectile nucleon in target nucleus
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_Ncoll_over_Npart_Optical_Glauber_multi_string
! #! event averaged N_bin
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_Ncoll_Optical_Glauber
! #! (Npart)mini-jet, Nnn, Npp=
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_Npart_call_PYTHIA, sum_Ncoll_nn_call_PYTHIA, sum_Ncoll_pp_call_PYTHIA
! #! Nnp, Ntot, Nep=
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_Ncoll_np_call_PYTHIA, sum_Ncoll_call_PYTHIA_2, sum_Ncoll_lp_call_PYTHIA
! 2 lines.
! For the case of random impact-parameter (b) sampling method.
        if( i_b_sampling_method == 1 ) then
        ! #! event averaged b, avneu, Npart_p, Npart_t, T_pt=
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
            write(100,*) sum_ave_b_param, sum_avneu,  &
                        sum_Npart_Optical_Glauber_proj, sum_Npart_Optical_Glauber_targ,  &
                        sum_Overlap_function_Optical_Glauber
! For the case of random impact-parameter (b) sampling method.
        ! else if( i_b_sampling_method == 2 ) then
        else
        ! #! psno, ave. b, N_part and N_bin =
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
            write(100,*) INT(i_b_sampling_method), sum_ave_b_param,  &
                        sum_Npart_Optical_Glauber_proj, sum_Npart_Optical_Glauber_targ,  &
                        sum_Ncoll_Optical_Glauber_2
! For the case of fixed impact-parameter (b).
        ! else
        ! !
        !     i_line = i_line + 1
        !     write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! !
        !     i_line = i_line + 1
        !     write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end if
! #!-----------------------------------------------------------------------------
! #! Angantyr mode event-averaged output:
! #! b, bPhi, bWeight =
        do j=1,3,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) sum_bParam_ANG
! #! glauberTot, glauberTotErr, glauberND, glauberNDErr (mb) =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) ( sum_sigma_ANG(1,i), i=1,2,1 ), ( sum_sigma_ANG(2,i), i=1,2,1 )
! #! glauberINEL, glauberINELErr, glauberEL, glauberELErr (mb) =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) ( sum_sigma_ANG(3,i), i=1,2,1 ), ( sum_sigma_ANG(4,i), i=1,2,1 )
! #! glauberDiffP, glauberDiffPErr, glauberDiffT, glauberDiffTErr (mb) =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) ( sum_sigma_ANG(5,i), i=1,2,1 ), ( sum_sigma_ANG(6,i), i=1,2,1 )
! #! glauberDDiff, glauberDDiffErr (mb), glauberBSlope, glauberBSlopeErr (mb) =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) ( sum_sigma_ANG(7,i), i=1,2,1 ), ( sum_sigma_ANG(8,i), i=1,2,1 )
! #! nCollTot, nCollND, nCollSDP, nCollSDT =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        write(100,*) ( sum_Ncoll_ANG(i), i=1,4,1 )
! #! nCollDD, nCollCD, nCollEl =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        write(100,*) ( sum_Ncoll_ANG(i), i=5,7,1 )
! #! nPartProj, nAbsProj, nDiffProj, nElProj =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        write(100,*) ( sum_Npart_ANG(i,1), i=1,4,1 )
! #! nPartTarg, nAbsTarg, nDiffTarg, nElTarg =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        write(100,*) ( sum_Npart_ANG(i,2), i=1,4,1 )
! #!-----------------------------------------------------------------------------
! #! event averaged energy of gamma after partonic initiation, partonic cascade,
! #!  hadronization and end of event =
        do j=1,3,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) sum_E_gamma_1, sum_E_gamma_2, sum_E_gamma_3, sum_E_gamma_4
! #!-----------------------------------------------------------------------------
! #! # of successful, blocked and all collision in parton cascade =
        do j=1,2,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) sum_n_coll_parton_rescattering_success,  &
                    sum_n_coll_parton_rescattering_block,    &
                    sum_n_coll_parton_rescattering_total
! #! average collision # in parton cascade =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_n_coll_parton_rescattering
! #! # of scaterring processes in parton cascade
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! #! q1 + q2 -> q1 + q2     q1 + q1 -> q1 + q1      q1 + q2bar -> q1 + q2bar    q1 + q1bar -> q2 + q2bar    q1 + q1bar -> q1 + q1bar
! Data.
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        write(100,*) ( sum_n_process_parton_rescattering(k), k=1,5,1 )
! #! q1 + q1bar -> g + g    g + g -> q1 + q1bar     q1 + g -> q1 + g            g + g -> g + g              Q + q -> Q + q
! Data.
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        write(100,*) ( sum_n_process_parton_rescattering(k), k=6,10,1 )
! #! Q + g -> Q + g         q + qbar -> Q + Qbar    g + g -> Q + Qbar           Q + Qbar -> q + qbar        Q + Qbar -> g + g
! Data.
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        write(100,*) ( sum_n_process_parton_rescattering(k), k=11,15,1 )
! #! average frequency of the occurring of each inela. in hadron cascade (at the end of the file)
! #! el. and inel. coll. # and sum in hadron cascade=
        do j=1,2,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) sum_n_coll_hadron_rescattering_elastic,      &
                     sum_n_coll_hadron_rescattering_inelastic,    &
                     sum_n_coll_hadron_rescattering_total
! #!-----------------------------------------------------------------------------
! #! default parj1, parj2, parj3, parj4, parj21 =
        do j=1,2,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) parj1_default, parj2_default, parj3_default, parj4_default, parj21_default
! #! Eff-parj1, parj2, parj3, parj4, parj21, keff =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_parj1_effective, sum_parj2_effective, sum_parj3_effective,   &
                     sum_parj4_effective, sum_parj21_effective, sum_kapa_effective
! #! averaged # of gluon in a string when kjp22=1,3
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_n_gluon_in_a_string_single_multi_string
! #! event averaged value of the factor related to # 
! #!  of gluons and hardest gluon in a string, event 
! #!  averaged transverse momentum of hardest gluon,
! #!  event averaged # strings when kjp22=1,3 =
        do j=1,4,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) sum_xi_factor_single_string, sum_pT_hardest_gluon_single_string, sum_n_string_single_string
! #!-----------------------------------------------------------------------------
! #! times & sum=
        do j=1,2,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) sum_time_NN_collision, sum_time_parton_rescattering, sum_time_hadron_rescattering,     &
                     sum_time_NN_collision + sum_time_parton_rescattering + sum_time_hadron_rescattering
! #!-----------------------------------------------------------------------------
! #! q, qbar, charge thrown away =
        do j=1,2,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) sum_n_q_thrown, sum_n_qbar_thrown, sum_charge_thrown
! #! 3-momentum and energy thrown away =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) sum_px_thrown, sum_py_thrown, sum_pz_thrown, sum_E_thrown
! #! Max 3-momentum and energy thrown away =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        write(100,*) max_lost_4mom

!==============================================================================!
! outputs the multiplicity and mean pT of hadrons in the partial and full 
!   phase-spaces.
!==============================================================================!
!
! #!-----------------------------------------------------------------------------
! #! multiplicity of negative, positive particles and sums, partial & full =
        do j=1,3,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) sum_multiplicity_minus_partial, sum_multiplicity_plus_partial,     &
                     sum_multiplicity_minus_partial + sum_multiplicity_plus_partial
        write(100,*) sum_multiplicity_minus_full, sum_multiplicity_plus_full,           &
                     sum_multiplicity_minus_full + sum_multiplicity_plus_full
! #!-----------------------------------------------------------------------------
! #! particle multiplicity, partial =
! #! tatol charged  pi+K+p name_1 ... name_20
        do j=1,3,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) ( sum_multiplicity_specie_partial(j), j=1,n_particle_specie,1 )
! #! particle multiplicity, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) ( sum_multiplicity_specie_full(j), j=1,n_particle_specie,1 )
! #!-----------------------------------------------------------------------------
! #! Number of particles for mean pT <pT>, partial =
        do j=1,2,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) ( sum_num_h_mean_pT(j,1), j=1,n_particle_specie,1 )
! #! Number of particles for mean pT <pT>, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) ( sum_num_h_mean_pT(j,2), j=1,n_particle_specie,1 )
! #! Total pT of particles, partial =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) ( sum_mean_pT_specie_partial(j), j=1,n_particle_specie,1 )
! #! Total pT of particles, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) ( sum_mean_pT_specie_full(j), j=1,n_particle_specie,1 )
! #! particle mean pT <pT>, partial =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) ( sum_mean_pT_specie_partial(j) &
                     / MAX( sum_num_h_mean_pT(j,1), 1D-10 ), &
                     j=1,n_particle_specie,1 )
! #! particle mean pT <pT>, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) ( sum_mean_pT_specie_full(j) &
                     / MAX( sum_num_h_mean_pT(j,2), 1D-10 ), &
                     j=1,n_particle_specie,1 )

!==============================================================================!
! Outputs flows of hadrons in the partial and full phase-spaces.
!==============================================================================!
! #!-----------------------------------------------------------------------------
! #! Number of particles for integtral flows, partial =
        do j=1,2,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
! Data.
        write(100,*) ( sum_num_h_integral_v(j,1), j=1,n_particle_specie,1 )
! #! Number of particles for integtral flows, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        write(100,*) ( sum_num_h_integral_v(j,2), j=1,n_particle_specie,1 )
! #! Total integral flows, v1, v2, v3, v4, partial =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        do i = 1, n_flow_type, 1
            write(100,*) ( sum_flow_h_integral_v(j,i,1), j=1,n_particle_specie,1 )
        end do
! #! Total integral flows, v1, v2, v3, v4, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        do i = 1, n_flow_type, 1
            write(100,*) ( sum_flow_h_integral_v(j,i,2), j=1,n_particle_specie,1 )
        end do
! #! Particle number averaged integral flows, v1, v2, v3, v4, partial =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        do i = 1, n_flow_type, 1
            write(100,*) ( sum_flow_h_integral_v(j,i,1) &
                         / MAX( sum_num_h_integral_v(j,1), 1D-10 ), &
                         j=1,n_particle_specie,1 )
        end do
! #! Particle number averaged integral flows, v1, v2, v3, v4, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Data.
        do i = 1, n_flow_type, 1
            write(100,*) ( sum_flow_h_integral_v(j,i,2) &
                         / MAX( sum_num_h_integral_v(j,2), 1D-10 ), &
                         j=1,n_particle_specie,1 )
        end do
!
!
!
        do j=1,3,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do

!==============================================================================!
! Outputs the data of "n_distribution" distributions for hadrons in the 
!   partial and full phase-spaces.
!==============================================================================!
        ! For hadrons:
        ! #!*******************|    Hadron  Distribution  Output    |******************!#
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        loop_hadron_output: do i_distr=1,n_distribution,1
            ! '8' distributions are used for '7', i.e. mean <pT>.
            if( i_distr == 8 ) cycle
            ! Partial phase-space.
            ! #!-----------------------------------------------------------------------------
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
            ! #! ID of distribution m2=           x    xxxx              
            ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
            ! #! x    total  charged  pi+K+p  name_1 ... name_20
            do j=1,3,1
                i_line = i_line + 1
                write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
            end do
            ! Outputs data of partial phase-space.
            if( i_distr /= 7 )then
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor(i_bin,i_distr),   &
                        ( sum_distr_hadron_partial(i_specie,i_bin,i_distr), i_specie=1,n_particle_specie,1 )
                end do
            else
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor(i_bin,i_distr),   &
                        ( ( sum_distr_hadron_partial(i_specie,i_bin,i_distr) &
                        / MAX( sum_distr_hadron_partial(i_specie,i_bin,8), 1D-10 ) ), &
                        i_specie=1,n_particle_specie,1 )
                end do
            end if
            ! Full phase-space.
            ! #! ID of distribution m2=           x    xxxx              
            ! #! full phase-space
            ! #! x    total  charged  pi+K+p  name_1 ... name_20
            do j=1,3,1
                i_line = i_line + 1
                write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
            end do
            ! Outputs data of full phase-space.
            if( i_distr /= 7 )then
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor(i_bin,i_distr),   &
                        ( sum_distr_hadron_full(i_specie,i_bin,i_distr), i_specie=1,n_particle_specie,1 )
                end do
            else
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor(i_bin,i_distr),   &
                        ( ( sum_distr_hadron_full(i_specie,i_bin,i_distr) &
                        / MAX( sum_distr_hadron_full(i_specie,i_bin,8), 1D-10 ) ), &
                        i_specie=1,n_particle_specie,1 )
                end do
            end if
            ! For mean pT <pT>.
            if( i_distr /= 7 ) cycle
            do i_distr2 = 8, 7, -1
                ! #! Num of particles for mean pT / Total pT
                ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                ! #! x    total  charged  pi+K+p  name_1 ... name_20
                do j=1,3,1
                    i_line = i_line + 1
                    write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                end do
                ! Data.
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor(i_bin,i_distr),   &
                    ( sum_distr_hadron_partial( i_specie, i_bin, i_distr2 ), i_specie=1,n_particle_specie,1 )
                end do
                ! #! Num of particles for mean pT / Total pT
                ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                ! #! x    total  charged  pi+K+p  name_1 ... name_20
                do j=1,3,1
                    i_line = i_line + 1
                    write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                end do
                ! Data.
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor(i_bin,i_distr),   &
                        ( sum_distr_hadron_full( i_specie, i_bin, i_distr2 ), i_specie=1,n_particle_specie,1 )
                end do
            end do
        end do loop_hadron_output
!
!
!
        do j=1,3,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do

!==============================================================================!
! Outpus the data of flows for hadrons in the 
!   partial and full phase-spaces.
!==============================================================================!
        ! For hadrons:
        ! #!***********************|    Hadron  Flow  Output    |**********************!#
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Ave. flows.
        do i_y_pT_eta = 1, n_y_pT_eta, 1
            do i_flow = 1, n_flow_type, 1
                ! Partial phase-space.
                ! #!-----------------------------------------------------------------------------
                i_line = i_line + 1
                write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                ! #! Particle number ave. xxx flow, v_i VS. ?
                ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                ! #! x    total  charged  pi+K+p  name_1 ... name_20
                do j=1,3,1
                    i_line = i_line + 1
                    write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                end do
                ! Data.
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor( i_bin, i_y_pT_eta ), &
                    ( sum_dv_h_flow( i_bin, i_flow, i_specie, i_y_pT_eta ) &
                    / MAX( sum_dN_h_flow( i_bin, i_specie, i_y_pT_eta ), 1D-10 ), &
                    i_specie=1,n_particle_specie,1 )
                end do
                ! Full phase-space.
                ! #! Particle number ave. xxx flow, v_i VS. ?
                ! #! full phase-space
                ! #! x    total  charged  pi+K+p  name_1 ... name_20
                do j=1,3,1
                    i_line = i_line + 1
                    write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                end do
                ! Data.
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor( i_bin, i_y_pT_eta ), &
                    ( sum_dv_h_flow_f( i_bin, i_flow, i_specie, i_y_pT_eta ) &
                    / MAX( sum_dN_h_flow_f( i_bin, i_specie, i_y_pT_eta ), 1D-10 ), &
                    i_specie=1,n_particle_specie,1 )
                end do
            end do
        end do
        ! Num of particles.
        do i_y_pT_eta = 1, n_y_pT_eta, 1
            ! Partial phase-space.
            ! #!-----------------------------------------------------------------------------
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
            ! #! Num of particles for diff. flows, N VS. ?
            ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
            ! #! x    total  charged  pi+K+p  name_1 ... name_20
            do j=1,3,1
                i_line = i_line + 1
                write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
            end do
            ! Reads out the data of partial phase-space.
            do i_bin=1,n_bin_hist,1
                write(100,*) x_coor( i_bin, i_y_pT_eta ), &
                ( sum_dN_h_flow( i_bin, i_specie, i_y_pT_eta ), i_specie=1,n_particle_specie,1 )
            end do
            ! Full phase-space.
            ! #! Num of particles for diff. flows, N VS. y
            ! #! full phase-space
            ! #! x    total  charged  pi+K+p  name_1 ... name_20
            do j=1,3,1
                i_line = i_line + 1
                write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
            end do
            ! Reads out the data of full phase-space.
            do i_bin=1,n_bin_hist,1
                write(100,*) x_coor( i_bin, i_y_pT_eta ), &
                ( sum_dN_h_flow_f( i_bin, i_specie, i_y_pT_eta ), i_specie=1,n_particle_specie,1 )
            end do
        end do
        ! Total flows.
        do i_y_pT_eta = 1, 3, 1
            do i_flow=1,n_flow_type,1
                ! Partial phase-space.
                ! #!-----------------------------------------------------------------------------
                i_line = i_line + 1
                write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                ! #! Total xxx flow, v_i VS. ?
                ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                ! #! x    total  charged  pi+K+p  name_1 ... name_20
                do j=1,3,1
                    i_line = i_line + 1
                    write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                end do
                ! Reads out the data of partial phase-space.
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor( i_bin, i_y_pT_eta ), &
                    ( sum_dv_h_flow( i_bin, i_flow, i_specie, i_y_pT_eta ), i_specie=1,n_particle_specie,1 )
                end do
                ! Full phase-space.
                ! #! Total xxx flow, v_i VS. ?
                ! #! full phase-space
                ! #! x    total  charged  pi+K+p  name_1 ... name_20
                do j=1,3,1
                    i_line = i_line + 1
                    write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                end do
                ! Reads out the data of full phase-space.
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor( i_bin, i_y_pT_eta ), &
                    ( sum_dv_h_flow_f( i_bin, i_flow, i_specie, i_y_pT_eta ), i_specie=1,n_particle_specie,1 )
                end do
            end do
        end do
        !
        !
        !
        do j=1,3,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do

!==============================================================================!
! Outputs the multiplicity and mean pT of partons in the partial and full 
!   phase-spaces.
!==============================================================================!
        ! For partons:
        ! #!-----------------------------------------------------------------------------
        ! #! multiplicity of negative, positive quark, sums and gluon, partial & full =
        do j=1,2,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
        ! Data.
        write(100,*) sum_multiplicity_quark_partial, sum_multiplicity_qbar_partial,     &
                     sum_multiplicity_quark_partial + sum_multiplicity_qbar_partial,    &
                     sum_multiplicity_gluon_partial
        ! Data.
        write(100,*) sum_multiplicity_quark_full, sum_multiplicity_qbar_full,       &
                     sum_multiplicity_quark_full + sum_multiplicity_qbar_full,      &
                     sum_multiplicity_gluon_full
        ! #!-----------------------------------------------------------------------------
        ! #! particle multiplicity, partial =
        ! #! g      u+d+s + anti- ... u, d, s, ...
        do j=1,3,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
        ! Data.
        write(100,*) ( sum_multiplicity_parton_partial(j), j=1,n_parton_specie,1 )
        ! #! particle multiplicity, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
        write(100,*) ( sum_multiplicity_parton_full(j), j=1,n_parton_specie,1 )
        ! #!-----------------------------------------------------------------------------
        ! #! Number of particles for mean pT <pT>, partial =
        do j=1,2,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
        ! Data.
        write(100,*) ( sum_num_p_mean_pT(j,1), j=1,n_parton_specie,1 )
        ! #! Number of particles for mean pT <pT>, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
        write(100,*) ( sum_num_p_mean_pT(j,2), j=1,n_parton_specie,1 )
        ! #! Total pT of particles, partial =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
        write(100,*) ( sum_mean_pT_parton_partial(j), j=1,n_parton_specie,1 )
        ! #! Total pT of particles, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
        write(100,*) ( sum_mean_pT_parton_full(j), j=1,n_parton_specie,1 )
        ! #! particle mean pT <pT>, partial =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
        write(100,*) ( sum_mean_pT_parton_partial(j) &
                     / MAX( sum_num_p_mean_pT(j,1), 1D-10 ), &
                     j=1,n_parton_specie,1 )
        ! #! particle mean pT <pT>, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
        write(100,*) ( sum_mean_pT_parton_full(j) &
                     / MAX( sum_num_p_mean_pT(j,2), 1D-10 ), &
                     j=1,n_parton_specie,1 )

!==============================================================================!
! Outputs flows of partons in the partial and full phase-spaces.
!==============================================================================!
        ! #!-----------------------------------------------------------------------------
        ! #! Number of particles for integtral flows, partial =
        do j=1,2,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do
        ! Data.
        write(100,*) ( sum_num_p_integral_v(j,1), j=1,n_parton_specie,1 )
        ! #! Number of particles for integtral flows, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
        write(100,*) ( sum_num_p_integral_v(j,2), j=1,n_parton_specie,1 )
        ! #! Total integral flows, v1, v2, v3, v4, partial =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
        do i = 1, n_flow_type, 1
            write(100,*) ( sum_flow_p_integral_v(j,i,1), j=1,n_parton_specie,1 )
        end do
        ! #! Total integral flows, v1, v2, v3, v4, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
        do i = 1, n_flow_type, 1
            write(100,*) ( sum_flow_p_integral_v(j,i,2), j=1,n_parton_specie,1 )
        end do
        ! #! Particle number averaged integral flows, v1, v2, v3, v4, partial =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
        do i = 1, n_flow_type, 1
            write(100,*) ( sum_flow_p_integral_v(j,i,1) &
                         / MAX( sum_num_p_integral_v(j,1), 1D-10 ), &
                         j=1,n_parton_specie,1 )
        end do
        ! #! Particle number averaged integral flows, v1, v2, v3, v4, full =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Data.
        do i = 1, n_flow_type, 1
            write(100,*) ( sum_flow_p_integral_v(j,i,2) &
                         / MAX( sum_num_p_integral_v(j,2), 1D-10 ), &
                         j=1,n_parton_specie,1 )
        end do
        !
        !
        !
        do j=1,3,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do

!==============================================================================!
! Outputs the data of "n_distribution" distributions for partons in the 
!   partial and full phase-spaces.
!==============================================================================!
        ! For partons:
        ! #!*******************|    Parton  Distribution  Output    |******************!#
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        loop_parton_output: do i_distr=1,n_distribution,1
            ! '8' distributions are used for '7', i.e. mean <pT>.
            if( i_distr == 8 ) cycle
            ! Partial phase-space.
            ! #!-----------------------------------------------------------------------------
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
            ! #! ID of distribution m2=           x    xxxx              
            ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
            ! #! x    g     u+d+s + anti-   u, d, s, ...
            do j=1,3,1
                i_line = i_line + 1
                write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
            end do
            ! Outputs data of partial phase-space.
            if( i_distr /= 7 )then
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor(i_bin,i_distr),   &
                        ( sum_distr_parton_partial(i_specie,i_bin,i_distr), i_specie=1,n_parton_specie,1 )
                end do
            else
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor(i_bin,i_distr),   &
                        ( ( sum_distr_parton_partial(i_specie,i_bin,i_distr) &
                        / MAX( sum_distr_parton_partial(i_specie,i_bin,8), 1D-10 ) ), &
                        i_specie=1,n_parton_specie,1 )
                end do
            end if
            ! Full phase-space.
            ! #! ID of distribution m2=           x    xxxx              
            ! #! full phase-space
            ! #! x    g     u+d+s + anti-   u, d, s, ...
            do j=1,3,1
                i_line = i_line + 1
                write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
            end do
            ! Outputs data of full phase-space.
            if( i_distr /= 7 )then
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor(i_bin,i_distr),   &
                        ( sum_distr_parton_full(i_specie,i_bin,i_distr), i_specie=1,n_parton_specie,1 )
                end do
            else
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor(i_bin,i_distr),   &
                        ( ( sum_distr_parton_full(i_specie,i_bin,i_distr) &
                        / MAX( sum_distr_parton_full(i_specie,i_bin,8), 1D-10 ) ), &
                        i_specie=1,n_parton_specie,1 )
                end do
            end if
            ! For mean pT <pT>.
            if( i_distr /= 7 ) cycle
            do i_distr2 = 8, 7, -1
                ! #! Num of particles for mean pT / Total pT
                ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                ! #! x    g     u+d+s + anti-   u, d, s, ...
                do j=1,3,1
                    i_line = i_line + 1
                    write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                end do
                ! Data.
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor(i_bin,i_distr),   &
                    ( distr_parton_partial( i_specie, i_bin, i_distr2 ), i_specie=1,n_parton_specie,1 )
                end do
                ! #! Num of particles for mean pT / Total pT
                ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                ! #! x    g     u+d+s + anti-   u, d, s, ...
                do j=1,3,1
                    i_line = i_line + 1
                    write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                end do
                ! Data.
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor(i_bin,i_distr),   &
                        ( distr_parton_full( i_specie, i_bin, i_distr2 ), i_specie=1,n_parton_specie,1 )
                end do
            end do
        end do loop_parton_output
!
!
!
        do j=1,3,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do

!==============================================================================!
! Outputs the data of flows for partons in the 
!   partial and full phase-spaces.
!==============================================================================!
        ! For partons:
        ! #!***********************|    Parton  Flow  Output    |**********************!#
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        ! Ave. flows.
        do i_y_pT_eta = 1, n_y_pT_eta, 1
            do i_flow = 1, n_flow_type, 1
                ! Partial phase-space.
                ! #!-----------------------------------------------------------------------------
                i_line = i_line + 1
                write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                ! #! Particle number ave. xxx flow, v_i VS. ?
                ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                ! #! x    g     u+d+s + anti-   u, d, s, ...
                do j=1,3,1
                    i_line = i_line + 1
                    write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                end do
                ! Data.
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor( i_bin, i_y_pT_eta ), &
                    ( dv_p_flow( i_bin, i_flow, i_specie, i_y_pT_eta ) &
                    / MAX( dN_p_flow( i_bin, i_specie, i_y_pT_eta ), 1D-10 ), &
                    i_specie=1,n_parton_specie,1 )
                end do
                ! Full phase-space.
                ! #! Particle number ave. xxx flow, v_i VS. ?
                ! #! full phase-space
                ! #! x    g     u+d+s + anti-   u, d, s, ...
                do j=1,3,1
                    i_line = i_line + 1
                    write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                end do
                ! Data.
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor( i_bin, i_y_pT_eta ), &
                    ( dv_p_flow_f( i_bin, i_flow, i_specie, i_y_pT_eta ) &
                    / MAX( dN_p_flow_f( i_bin, i_specie, i_y_pT_eta ), 1D-10 ), &
                    i_specie=1,n_parton_specie,1 )
                end do
            end do
        end do
        ! Num of particles.
        do i_y_pT_eta = 1, n_y_pT_eta, 1
            ! Partial phase-space.
            ! #!-----------------------------------------------------------------------------
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
            ! #! Num of particles for diff. flows, N VS. ?
            ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
            ! #! x    g     u+d+s + anti-   u, d, s, ...
            do j=1,3,1
                i_line = i_line + 1
                write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
            end do
            ! Reads out the data of partial phase-space.
            do i_bin=1,n_bin_hist,1
                write(100,*) x_coor( i_bin, i_y_pT_eta ), &
                ( sum_dN_p_flow( i_bin, i_specie, i_y_pT_eta ), &
                i_specie=1,n_parton_specie,1 )
            end do
            ! Full phase-space.
            ! #! Num of particles for diff. flows, N VS. y
            ! #! full phase-space
            ! #! x    g     u+d+s + anti-   u, d, s, ...
            do j=1,3,1
                i_line = i_line + 1
                write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
            end do
            ! Reads out the data of full phase-space.
            do i_bin=1,n_bin_hist,1
                write(100,*) x_coor( i_bin, i_y_pT_eta ), &
                ( sum_dN_p_flow_f( i_bin, i_specie, i_y_pT_eta ), &
                i_specie=1,n_parton_specie,1 )
            end do
        end do
        ! Total flows.
        do i_y_pT_eta = 1, 3, 1
            do i_flow =1,n_flow_type,1
                ! Partial phase-space.
                ! #!-----------------------------------------------------------------------------
                i_line = i_line + 1
                write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                ! #! Total xxx flow, v_i VS. ?
                ! #! partial phase-space,  x.xx < pT <  x.xx  (nominal cuts of 1-st setting in usu.dat)
                ! #! x    total  charged  pi+K+p  name_1 ... name_20
                do j=1,3,1
                    i_line = i_line + 1
                    write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                end do
                ! Reads out the data of partial phase-space.
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor( i_bin, i_y_pT_eta ), &
                    ( sum_dv_p_flow( i_bin, i_flow, i_specie, i_y_pT_eta ), &
                    i_specie=1,n_parton_specie,1 )
                end do
                ! Full phase-space.
                ! #! Total xxx flow, v_i VS. ?
                ! #! full phase-space
                ! #! x    total  charged  pi+K+p  name_1 ... name_20
                do j=1,3,1
                    i_line = i_line + 1
                    write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
                end do
                ! Reads out the data of full phase-space.
                do i_bin=1,n_bin_hist,1
                    write(100,*) x_coor( i_bin, i_y_pT_eta ), &
                    ( sum_dv_p_flow_f( i_bin, i_flow, i_specie, i_y_pT_eta ), &
                    i_specie=1,n_parton_specie,1 )
                end do
            end do
        end do
        !
        !
        !
        do j=1,3,1
            i_line = i_line + 1
            write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
        end do

!==============================================================================!
! Outputs the frequency of the occurring of each inela. in hadron cascade.
!==============================================================================!
! #! average frequency of the occurring of each inela. in hadron cascade =
        i_line = i_line + 1
        write(100,*) TRIM(ADJUSTL( comment_line( i_line ) ))
! Outputs data.
        do j=1,60,1
            write(100,*) ( sum_n_process_hadron_rescattering(k,j), k=1,10,1 )
        end do

        close(100)

        write(*,*) "Rms_analysis running finished!"


        stop
    end program